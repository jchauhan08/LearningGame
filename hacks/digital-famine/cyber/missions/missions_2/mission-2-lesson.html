---
layout: page
title: Mission 2 ‚Äî Build the Base Database
permalink: /digital-famine/cybersecurity-game/mission-2-lesson/
author: Aaryav Lal
microblog: True
breadcrumb: True
date: 2025-10-26
footer:
  previous: /digital-famine/cybersecurity-game/mission-1-lesson
  home: /digital-famine/cybersecurity-game
  next: /digital-famine/cybersecurity-game/mission-3-lesson/
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission 2: Patch the Wormhole</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body.mission2-body-bg {
            background:
                radial-gradient(140% 140% at 15% -10%, rgba(94, 234, 212, 0.2) 0%, transparent 65%),
                radial-gradient(130% 150% at 80% 0%, rgba(126, 58, 242, 0.16) 0%, transparent 70%),
                radial-gradient(120% 150% at 50% 100%, rgba(45, 212, 191, 0.14) 0%, transparent 60%),
                linear-gradient(188deg, #030712 0%, #050b1c 45%, #0a132b 100%);
            min-height: 100vh;
            color: #f5f8ff;
            background-attachment: fixed;
        }
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .section-hidden { display: none; }
        .mission2-container {
            position: relative;
            padding: 3.5rem 1.8rem 4rem;
            background: radial-gradient(120% 160% at 50% 0%, rgba(13, 23, 43, 0.92) 0%, rgba(6, 10, 22, 0.98) 45%, rgba(2, 4, 12, 0.99) 100%);
            border-radius: 2rem;
            overflow: hidden;
            box-shadow: 0 35px 80px rgba(0, 0, 0, 0.55);
            max-width: 1200px;
            margin: 2rem auto;
        }
        .mission2-container::before {
            content: "";
            position: absolute;
            inset: -10% -20%;
            background:
                radial-gradient(circle at 20% 20%, rgba(94, 234, 212, 0.24), transparent 60%),
                radial-gradient(circle at 80% 15%, rgba(126, 58, 242, 0.22), transparent 65%),
                radial-gradient(circle at 50% 80%, rgba(56, 189, 248, 0.18), transparent 55%);
            opacity: 0.85;
            pointer-events: none;
        }
        .mission2-container::after {
            content: "";
            position: absolute;
            inset: 0;
            background-image: radial-gradient(rgba(255, 255, 255, 0.08) 1px, transparent 1px);
            background-size: 85px 85px;
            opacity: 0.22;
            mix-blend-mode: screen;
            pointer-events: none;
        }
        .mission2-container > * {
            position: relative;
            z-index: 1;
        }
        .mission2-card, .mission-section > div > div.bg-slate-800\/70, .mission-section > div > div.bg-slate-800\/50 {
            background: rgba(7, 13, 27, 0.88) !important;
            color: #e6edff !important;
            border-radius: 1.25rem !important;
            border: 1px solid rgba(94, 234, 212, 0.22) !important;
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.4) !important;
        }
        .mission2-card h2, .mission2-card h3, .mission2-card h4 {
            color: #67e8f9 !important;
        }
        .mission-section button {
            background: linear-gradient(98deg, #0ea5e9 0%, #14b8a6 55%, #7c3aed 100%) !important;
            color: #fff !important;
            border: none !important;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(14, 165, 233, 0.2);
        }
        .mission-section button:hover {
            background: linear-gradient(98deg, #0284c7 0%, #0d9488 55%, #6d28d9 100%) !important;
        }
        .mission-section .bg-blue-900\/20, .mission-section .bg-red-900\/20, .mission-section .bg-green-900\/20 {
            background: rgba(33, 150, 243, 0.10) !important;
            border: 1px solid rgba(120, 214, 255, 0.18) !important;
        }
        .mission-section .bg-slate-950 {
            background: rgba(12, 18, 34, 0.9) !important;
            color: #9bd9ff !important;
        }
        .mission-section table th, .mission-section table td {
            color: #e6edff !important;
        }
        .mission-section .text-blue-300, .mission-section .text-red-300, .mission-section .text-green-300, .mission-section .text-purple-300 {
            color: #78d6ff !important;
        }
        .mission-section .border-blue-500\/30, .mission-section .border-red-500\/30, .mission-section .border-green-500\/30, .mission-section .border-purple-500\/30 {
            border-color: rgba(120, 214, 255, 0.25) !important;
        }
        .mission-section .text-red-400, .mission-section .text-green-400, .mission-section .text-yellow-400 {
            color: #f9d949 !important;
        }
        .mission-section .bg-yellow-900\/30 {
            background: rgba(249, 217, 73, 0.12) !important;
            border-color: #ffe58a !important;
        }
        .mission-section .bg-slate-900\/50, .mission-section .bg-slate-900\/70 {
            background: rgba(19, 28, 48, 0.95) !important;
        }
        .mission-section .border-purple-500\/30 {
            border-color: rgba(120, 214, 255, 0.25) !important;
        }
        .mission-section .text-purple-400 {
            color: #78d6ff !important;
        }
        .mission-section .text-blue-400 {
            color: #78d6ff !important;
        }
        .mission-section .text-red-400 {
            color: #f9d949 !important;
        }
        .mission-section .text-green-300 {
            color: #82ffa4 !important;
        }
        .mission-section .text-yellow-400 {
            color: #ffe58a !important;
        }
        .mission-section .text-gray-300 {
            color: #c9d8ff !important;
        }
        .mission-section .font-semibold {
            font-weight: 600 !important;
        }
        .mission-section .rounded-lg {
            border-radius: 1.25rem !important;
        }
        .mission-section .font-mono {
            font-family: 'Fira Mono', 'Consolas', 'Menlo', monospace !important;
        }
        @media (max-width: 680px) {
            .mission2-container {
                padding: 1.6rem 0.5rem 2rem;
            }
        }
    </style>
</head>
<body class="mission2-body-bg">
    <div class="mission2-container">
        <div class="mission2-card" style="margin-bottom:2rem;">
            <div class="flex items-center justify-between overflow-x-auto pb-2 gap-2">
                <button onclick="goToSection(0)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-teal-500/80 text-slate-900 shadow-lg shadow-teal-400/30" data-section="0">
                    <span class="text-2xl mb-1">üì°</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Briefing</span>
                </button>
                <div class="w-8 h-0.5 bg-cyan-500/30"></div>
                <button onclick="goToSection(1)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-slate-800/60 text-slate-300" data-section="1">
                    <span class="text-2xl mb-1">‚ö†Ô∏è</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Threat</span>
                </button>
                <div class="w-8 h-0.5 bg-cyan-500/30"></div>
                <button onclick="goToSection(2)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-slate-800/60 text-slate-300" data-section="2">
                    <span class="text-2xl mb-1">üõ∞Ô∏è</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Recon</span>
                </button>
                <div class="w-8 h-0.5 bg-cyan-500/30"></div>
                <button onclick="goToSection(3)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-slate-800/60 text-slate-300" data-section="3">
                    <span class="text-2xl mb-1">üí•</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Lab</span>
                </button>
                <div class="w-8 h-0.5 bg-cyan-500/30"></div>
                <button onclick="goToSection(4)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-slate-800/60 text-slate-300" data-section="4">
                    <span class="text-2xl mb-1">üõ°Ô∏è</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Secure</span>
                </button>
                <div class="w-8 h-0.5 bg-cyan-500/30"></div>
                <button onclick="goToSection(5)" class="nav-btn flex flex-col items-center min-w-[110px] px-3 py-2 rounded-lg transition-all bg-slate-800/60 text-slate-300" data-section="5">
                    <span class="text-2xl mb-1">üõ∞Ô∏è</span>
                    <span class="text-xs text-center tracking-[0.35em] uppercase">Debrief</span>
                </button>
            </div>
        </div>

        <div id="section-0" class="mission-section">
            <div class="space-y-6">
                <div class="mission2-card border border-cyan-500/30 bg-slate-900/80 p-8">
                    <div class="grid gap-8 lg:grid-cols-[1.2fr_0.8fr] lg:items-center">
                        <div class="space-y-5">
                            <p class="inline-flex items-center gap-2 rounded-full border border-cyan-400/50 bg-cyan-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em] text-cyan-200">
                                Mission 2 ¬∑ Wormhole Patch
                            </p>
                            <h1 class="text-3xl font-bold text-cyan-100 md:text-4xl">Seal the Alien SQL Injection Wormhole</h1>
                            <p class="text-sm leading-6 text-slate-200 md:text-base">
                                HQ intercepted an outdated login endpoint. The syndicate injects the payload <code class="text-cyan-200">' OR '1'='1</code> and the database grants every request. Your operation mirrors real incident response:
                                <span class="mission-accent font-semibold">replicate the breach, collect forensic proof, then rebuild the gateway using parameterized defenses</span>.
                            </p>
                            <p class="text-sm leading-6 text-slate-200 md:text-base">
                                Work through each stage, execute the wormhole lab, and deliver an evidence pack that satisfies both the red-team verification and blue-team remediation checklists.
                            </p>
                        </div>
                        <div class="grid gap-4 rounded-3xl border border-cyan-400/20 bg-slate-950/70 p-6 text-sm text-slate-200">
                            <div class="flex items-center justify-between">
                                <span class="uppercase tracking-[0.28em] text-cyan-200">Estimated Time</span>
                                <span class="font-semibold text-cyan-100">25 ‚Äì 35 minutes</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="uppercase tracking-[0.28em] text-cyan-200">Required Skills</span>
                                <span class="font-semibold text-cyan-100">SQL, Auth, OWASP A03</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="uppercase tracking-[0.28em] text-cyan-200">Reward Fragment</span>
                                <span class="font-semibold text-cyan-100">BRAVO-4M8Q</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mission2-card border border-slate-800/50 bg-slate-900/80 p-8">
                    <div class="grid gap-6 md:grid-cols-3">
                        <div class="panel-border bg-slate-900/80 p-5">
                            <p class="text-xs uppercase tracking-[0.35em] text-cyan-200">Deliverable</p>
                            <h3 class="mt-3 text-lg font-semibold text-cyan-100">Breach Evidence Packet</h3>
                            <p class="mt-3 text-sm text-slate-200">Console snapshot with injected SQL, leaked agents, and HQ alarm.</p>
                        </div>
                        <div class="panel-border bg-slate-900/80 p-5">
                            <p class="text-xs uppercase tracking-[0.35em] text-cyan-200">Deliverable</p>
                            <h3 class="mt-3 text-lg font-semibold text-cyan-100">Remediation Log</h3>
                            <p class="mt-3 text-sm text-slate-200">Before/after code excerpts plus notes on how parameter binding neutralizes the payload.</p>
                        </div>
                        <div class="panel-border bg-slate-900/80 p-5">
                            <p class="text-xs uppercase tracking-[0.35em] text-cyan-200">Deliverable</p>
                            <h3 class="mt-3 text-lg font-semibold text-cyan-100">Vault Fragment</h3>
                            <p class="mt-3 text-sm text-slate-200">Unlocked once secure mode blocks the attack and a valid agent succeeds.</p>
                        </div>
                    </div>
                </div>
                <button onclick="goToSection(1)" class="nav-primary w-full rounded-xl px-6 py-3 md:w-auto">Begin Recon</button>
            </div>
        </div>

        <div id="section-1" class="mission-section section-hidden">
            <div class="space-y-6">
                <div class="mission2-card border border-rose-400/30 bg-slate-900/85 p-8">
                    <div class="grid gap-6 lg:grid-cols-[1fr_1fr]">
                        <article class="panel-border bg-rose-500/10 p-6">
                            <h2 class="text-3xl font-bold text-rose-100 mb-4">‚ö†Ô∏è Threat Intel ¬∑ Injection Anatomy</h2>
                            <p class="text-sm leading-7 text-rose-100/85">
                                The wormhole opens when the attacker concatenates the payload <code class="text-rose-200">' OR '1'='1</code> directly into the login SQL. The WHERE clause evaluates to TRUE for every record, granting access to the entire agent roster and any linked missions.
                            </p>
                            <ul class="mt-5 space-y-2 text-sm text-rose-100/80">
                                <li>‚Ä¢ <strong>Vector:</strong> User input stitched into SQL without placeholders.</li>
                                <li>‚Ä¢ <strong>Impact:</strong> Authentication bypass, mass data leak, privilege escalation.</li>
                                <li>‚Ä¢ <strong>Indicators:</strong> Repeated `'1'='1` signatures and full-table result sets in logs.</li>
                            </ul>
                        </article>
                        <article class="panel-border bg-slate-900/80 p-6">
                            <h3 class="text-2xl font-semibold text-cyan-100 mb-4">Real-World Parallels</h3>
                            <p class="text-sm leading-7 text-slate-200">
                                From the classic XKCD ‚ÄúLittle Bobby Tables‚Äù strip to the Yahoo breach, SQL injection remains one of the most exploited flaws (OWASP A03). Red teams still rely on this exact payload because legacy apps continue to concatenate strings. Blue teams respond by reproducing the attack, documenting evidence, and rolling out parameterized queries with validation.
                            </p>
                            <p class="mt-4 text-sm leading-7 text-slate-200">
                                Follow the same cadence here: prove the breach exists, capture the telemetry, then neutralize it with secure coding practices.
                            </p>
                        </article>
                    </div>
                </div>
                <div class="mission2-card border border-slate-800/40 bg-slate-900/80 p-8">
                    <h3 class="text-lg font-semibold text-cyan-100 mb-4">Recon Objectives</h3>
                    <div class="grid gap-5 md:grid-cols-3">
                        <div class="panel-border bg-slate-900/75 p-5">
                            <p class="text-xs uppercase tracking-[0.32em] text-cyan-200">Collect Payload</p>
                            <p class="mt-3 text-sm text-slate-200">Highlight where the alien string rewrites the SQL. Screenshot the vulnerable statement.</p>
                        </div>
                        <div class="panel-border bg-slate-900/75 p-5">
                            <p class="text-xs uppercase tracking-[0.32em] text-cyan-200">Measure Blast Radius</p>
                            <p class="mt-3 text-sm text-slate-200">Record which rows leak. This becomes your incident impact summary.</p>
                        </div>
                        <div class="panel-border bg-slate-900/75 p-5">
                            <p class="text-xs uppercase tracking-[0.32em] text-cyan-200">Plan Containment</p>
                            <p class="mt-3 text-sm text-slate-200">List the code hotspots that must change: query builder, validation, logs.</p>
                        </div>
                    </div>
                </div>
                <button onclick="goToSection(2)" class="nav-primary w-full rounded-xl px-6 py-3 md:w-auto">Continue to Recon</button>
            </div>
        </div>

        <div id="section-2" class="mission-section section-hidden">
            <div class="space-y-6">
                <div class="mission2-card border border-cyan-400/30 bg-slate-900/85 p-8">
                    <div class="grid gap-6 lg:grid-cols-[1.1fr_0.9fr]">
                        <article class="panel-border bg-cyan-500/10 p-6">
                            <h2 class="text-3xl font-bold text-cyan-100 mb-4">üõ∞Ô∏è Recon Toolkit</h2>
                            <p class="text-sm leading-7 text-cyan-100/85">
                                Analysts lean on repeatable payloads and log scrapers to prove how an attack mutates SQL. In this mission the wormhole console provides a live view of the crafted query. Capture the console output and indicator states‚Äîthey form the evidence bundle for HQ.
                            </p>
                            <div class="mt-5 rounded-2xl border border-cyan-400/30 bg-slate-950/80 p-4 text-xs font-mono text-cyan-100">
                                SELECT * FROM agents<br />
                                &nbsp;&nbsp;WHERE codename = '<span class="text-rose-200">GhostWolf</span>'<br />
                                &nbsp;&nbsp;AND passcode = '<span class="text-rose-200">' OR '1'='1</span>';
                            </div>
                        </article>
                        <article class="panel-border bg-slate-900/80 p-6">
                            <h3 class="text-2xl font-semibold text-cyan-100 mb-4">Recon Checklist</h3>
                            <ol class="space-y-3 text-sm text-slate-200">
                                <li><span class="font-semibold text-cyan-200">1.</span> Execute the payload with secure mode off and record the SQL emitted.</li>
                                <li><span class="font-semibold text-cyan-200">2.</span> Log breach indicator color, HQ transmission, and rows returned.</li>
                                <li><span class="font-semibold text-cyan-200">3.</span> Reset the console if you need a clean baseline before the lab run.</li>
                                <li><span class="font-semibold text-cyan-200">4.</span> Prepare questions for engineering: Where does the string concatenation live? Which endpoints reuse it?</li>
                            </ol>
                            <p class="mt-4 text-sm text-slate-200">
                                Once your recon notes are ready, advance to the wormhole lab to reproduce the exploit live.
                            </p>
                        </article>
                    </div>
                </div>
                <button onclick="goToSection(3)" class="nav-primary w-full rounded-xl px-6 py-3 md:w-auto">Enter Wormhole Lab</button>
            </div>
        </div>

        <div id="section-3" class="mission-section section-hidden">
            <div class="space-y-6">
                <div class="mission2-card border border-purple-400/30 bg-slate-900/85 p-8">
                    <div class="flex flex-col gap-6 lg:flex-row lg:items-start">
                        <div class="flex-1 space-y-6">
                            <article class="panel-border bg-purple-500/10 p-6 text-sm text-purple-100">
                                <h2 class="text-3xl font-bold text-purple-100 mb-4">üí• Wormhole Lab</h2>
                                <p class="leading-6">
                                    Use the console to mimic the attacker and defender workflows. Prime the payload to prove the wormhole is open, then flip to secure mode and demonstrate containment. HQ expects screenshots from both states.
                                </p>
                                <div class="mt-4 flex flex-wrap gap-3">
                                    <button id="btn-load-payload" type="button" class="stat-pill bg-rose-500/15 text-rose-100 hover:bg-rose-500/25">üí• Load Alien Payload</button>
                                    <button id="btn-load-agent" type="button" class="stat-pill bg-emerald-500/15 text-emerald-100 hover:bg-emerald-500/25">üõ°Ô∏è Load GhostWolf</button>
                                    <button id="btn-reset-lab" type="button" class="stat-pill bg-slate-800/70 text-slate-200 hover:bg-slate-700/75">üîÑ Reset Lab</button>
                                </div>
                            </article>

                            <form id="wormhole-form" class="panel-border bg-slate-900/85 p-6 space-y-5">
                                <div class="grid gap-4 md:grid-cols-2">
                                    <div class="space-y-2">
                                        <label for="codename-input" class="text-xs font-semibold uppercase tracking-[0.32em] text-slate-400">Codename</label>
                                        <input
                                            id="codename-input"
                                            name="codename"
                                            placeholder="GhostWolf"
                                            required
                                            class="w-full rounded-xl border border-slate-700/60 bg-slate-950/80 px-4 py-2.5 text-sm text-slate-100 placeholder:text-slate-500 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"
                                        />
                                    </div>
                                    <div class="space-y-2">
                                        <label for="passcode-input" class="text-xs font-semibold uppercase tracking-[0.32em] text-slate-400">Passcode</label>
                                        <input
                                            id="passcode-input"
                                            name="passcode"
                                            placeholder="hunter2"
                                            required
                                            class="w-full rounded-xl border border-slate-700/60 bg-slate-950/80 px-4 py-2.5 text-sm text-slate-100 placeholder:text-slate-500 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"
                                        />
                                    </div>
                                </div>

                                <label class="flex items-center gap-4 rounded-xl border border-slate-700/60 bg-slate-950/70 px-4 py-3 text-sm text-slate-200" for="secure-toggle">
                                    <input type="checkbox" id="secure-toggle" class="h-5 w-5 rounded border-slate-600 bg-slate-900 text-emerald-400 focus:ring-emerald-500" />
                                    <div>
                                        <p class="font-semibold text-slate-100">Secure Mode</p>
                                        <p class="text-xs text-slate-400">Prepared statement + parameter binding. Payload treated as data.</p>
                                    </div>
                                </label>

                                <button type="submit" class="nav-primary w-full rounded-xl px-5 py-3">Execute Query</button>
                            </form>
                        </div>

                        <div class="panel-border bg-slate-900/85 p-6 lg:w-[380px]">
                            <div class="space-y-5">
                                <div>
                                    <h3 class="text-sm font-semibold uppercase tracking-[0.32em] text-cyan-200">Command Log</h3>
                                    <pre id="log-output" class="mt-3 h-52 overflow-y-auto rounded-xl border border-slate-700/60 bg-slate-950/80 p-4 text-xs text-slate-100">$ Awaiting input‚Ä¶</pre>
                                </div>
                                <div class="grid gap-3">
                                    <div id="breach-status" class="rounded-xl border border-slate-700/50 bg-slate-950/70 px-4 py-3 text-sm font-semibold text-slate-200">
                                        Breach Status: Pending
                                    </div>
                                    <div id="telemetry-status" class="rounded-xl border border-slate-700/50 bg-slate-950/70 px-4 py-3 text-sm text-slate-200">
                                        Telemetry: Wormhole readings stable
                                    </div>
                                </div>
                                <div>
                                    <h3 class="text-sm font-semibold uppercase tracking-[0.32em] text-cyan-200">Ops Metrics</h3>
                                    <div class="mt-3 grid gap-3 md:grid-cols-3">
                                        <div class="panel-border bg-slate-950/80 p-3 text-center">
                                            <p class="text-[0.65rem] uppercase tracking-[0.32em] text-slate-400">Attempts</p>
                                            <p class="text-xl font-semibold text-cyan-100" id="stat-attempts">0</p>
                                        </div>
                                        <div class="panel-border bg-slate-950/80 p-3 text-center">
                                            <p class="text-[0.65rem] uppercase tracking-[0.32em] text-slate-400">Breaches</p>
                                            <p class="text-xl font-semibold text-rose-200" id="stat-breaches">0</p>
                                        </div>
                                        <div class="panel-border bg-slate-950/80 p-3 text-center">
                                            <p class="text-[0.65rem] uppercase tracking-[0.32em] text-slate-400">Secure Runs</p>
                                            <p class="text-xl font-semibold text-emerald-200" id="stat-secure">0</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mission2-card border border-slate-800/40 bg-slate-900/80 p-8">
                    <p class="text-sm leading-6 text-slate-200">
                        Capture console output, breach indicators, and HQ transmissions from both vulnerable and secure runs. These artifacts become your mission dossier and inform the deployment checklist in the next stage.
                    </p>
                </div>
                <button onclick="goToSection(4)" class="nav-primary w-full rounded-xl px-6 py-3 md:w-auto">Review Secure Fix</button>
            </div>
        </div>

        <div id="section-4" class="mission-section section-hidden">
            <div class="space-y-6">
                <div class="mission2-card border border-emerald-400/30 bg-slate-900/85 p-8">
                    <div class="grid gap-6 lg:grid-cols-[1fr_1fr]">
                        <article class="panel-border bg-emerald-500/10 p-6">
                            <h2 class="text-3xl font-bold text-emerald-50 mb-4">üõ°Ô∏è Secure Coding Playbook</h2>
                            <p class="text-sm leading-7 text-emerald-100/85">
                                Parameterized queries separate SQL structure from user input. The database engine receives the template first, then binds parameters as data. The payload never merges into the statement, so hostile strings remain harmless text.
                            </p>
                            <div class="mt-5 grid gap-4 rounded-2xl border border-emerald-400/30 bg-slate-950/80 p-4 text-xs font-mono text-emerald-100">
                                <div>
                                    <p class="font-semibold text-emerald-200">Before (Vulnerable)</p>
                                    <p>const query = `SELECT * FROM agents WHERE codename='${codename}' AND passcode='${passcode}'`;</p>
                                </div>
                                <div>
                                    <p class="font-semibold text-emerald-200">After (Secure)</p>
                                    <p>const query = "SELECT * FROM agents WHERE codename = ? AND passcode = ?";</p>
                                    <p>db.prepare(query).bind([codename, passcode]).all();</p>
                                </div>
                            </div>
                            <p class="mt-4 text-sm text-emerald-100/85">
                                <strong>Reality check:</strong> OWASP ASVS and most compliance baselines demand proof of parameter binding before release.
                            </p>
                        </article>
                        <article class="panel-border bg-slate-900/80 p-6">
                            <h3 class="text-2xl font-semibold text-cyan-100 mb-4">Secure Deployment Checklist</h3>
                            <ol class="space-y-3 text-sm text-slate-200">
                                <li><span class="font-semibold text-cyan-200">1.</span> Run the payload with Secure Mode enabled ‚Üí expect zero rows.</li>
                                <li><span class="font-semibold text-cyan-200">2.</span> Authenticate GhostWolf under Secure Mode ‚Üí expect a single authorized row.</li>
                                <li><span class="font-semibold text-cyan-200">3.</span> Capture the HQ transmission announcing the vault fragment.</li>
                                <li><span class="font-semibold text-cyan-200">4.</span> Archive the before/after code snippet for peer review.</li>
                            </ol>
                            <p class="mt-4 text-sm text-slate-200">
                                Production teams automate these checks after every deploy. When the console reports ‚ÄúGhostWolf cleared,‚Äù you‚Äôre mirroring those guardrails.
                            </p>
                        </article>
                    </div>
                </div>
                <button onclick="goToSection(5)" class="nav-primary w-full rounded-xl px-6 py-3 md:w-auto">Proceed to Debrief</button>
            </div>
        </div>

        <div id="section-5" class="mission-section section-hidden">
            <div class="space-y-6">
                <div class="mission2-card border border-indigo-400/30 bg-slate-900/85 p-8">
                    <div class="grid gap-6 lg:grid-cols-[1.1fr_0.9fr]">
                        <article class="panel-border bg-slate-900/80 p-6">
                            <h2 class="text-3xl font-bold text-cyan-100 mb-4">üõ∞Ô∏è Debrief &amp; Evidence Bundle</h2>
                            <ul class="space-y-3 text-sm text-slate-200">
                                <li><span class="font-semibold text-cyan-200">‚úî</span> Breach console output showing the injected SQL and leaked agents.</li>
                                <li><span class="font-semibold text-cyan-200">‚úî</span> Secure console output proving the payload was neutralized and GhostWolf authenticated.</li>
                                <li><span class="font-semibold text-cyan-200">‚úî</span> Before/after code snippet documenting the parameterized fix.</li>
                                <li><span class="font-semibold text-cyan-200">‚úî</span> HQ transmission confirming the vault fragment release.</li>
                            </ul>
                            <p class="mt-4 text-sm text-slate-200">
                                Package these artifacts into your mission log and share them with the security council before advancing to Mission 3.
                            </p>
                        </article>
                        <article class="panel-border bg-indigo-500/10 p-6 text-center">
                            <h2 class="text-xl font-semibold text-indigo-50">Vault Fragment</h2>
                            <p id="success-code" class="mt-6 font-mono text-2xl uppercase tracking-[0.45em] text-slate-500">Locked</p>
                            <p class="mt-3 text-sm text-indigo-100">Unlocks after a secure run blocks the payload and verifies GhostWolf.</p>
                            <p class="mt-5 text-xs uppercase tracking-[0.32em] text-indigo-200">Transmit to HQ once recovered.</p>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const sections = Array.from(document.querySelectorAll(".mission-section"));
        const navButtons = Array.from(document.querySelectorAll(".nav-btn"));

        function goToSection(index) {
            sections.forEach((section, idx) => {
                section.classList.toggle("section-hidden", idx !== index);
            });

            navButtons.forEach((btn) => {
                btn.classList.remove("bg-teal-500/80", "text-slate-900", "shadow-lg", "shadow-teal-400/30");
                btn.classList.add("bg-slate-800/60", "text-slate-300");
            });

            const active = navButtons[index];
            if (active) {
                active.classList.remove("bg-slate-800/60", "text-slate-300");
                active.classList.add("bg-teal-500/80", "text-slate-900", "shadow-lg", "shadow-teal-400/30");
            }

            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        window.goToSection = goToSection;
        goToSection(0);

        const form = document.getElementById("wormhole-form");
        const codenameInput = document.getElementById("codename-input");
        const passcodeInput = document.getElementById("passcode-input");
        const secureToggle = document.getElementById("secure-toggle");
        const logOutput = document.getElementById("log-output");
        const breachStatus = document.getElementById("breach-status");
        const telemetryStatus = document.getElementById("telemetry-status");
        const statAttempts = document.getElementById("stat-attempts");
        const statBreaches = document.getElementById("stat-breaches");
        const statSecure = document.getElementById("stat-secure");
        const successCode = document.getElementById("success-code");
        const btnLoadPayload = document.getElementById("btn-load-payload");
        const btnLoadAgent = document.getElementById("btn-load-agent");
        const btnResetLab = document.getElementById("btn-reset-lab");

        const AGENT_DB = [
            { codename: "GhostWolf", passcode: "hunter2", clearance: "Top Secret" },
            { codename: "NightFox", passcode: "wrath238", clearance: "Secret" },
            { codename: "AstraZero", passcode: "blueNova!", clearance: "Confidential" },
        ];

        const PAYLOAD = "' OR '1'='1";
        const SUCCESS_FRAGMENT = "BRAVO-4M8Q";

        const stats = { attempts: 0, breaches: 0, secureRuns: 0 };
        let vaultUnlocked = false;

        function lockVault() {
            if (!successCode) return;
            successCode.textContent = "Locked";
            successCode.classList.remove("text-cyan-200");
            successCode.classList.add("text-slate-500");
        }

        function unlockVault() {
            if (!successCode) return;
            successCode.textContent = SUCCESS_FRAGMENT;
            successCode.classList.remove("text-slate-500");
            successCode.classList.add("text-cyan-200");
        }

        function renderStats() {
            if (statAttempts) statAttempts.textContent = stats.attempts;
            if (statBreaches) statBreaches.textContent = stats.breaches;
            if (statSecure) statSecure.textContent = stats.secureRuns;
        }

        function setStatuses({ breached, neutralised, message }) {
            if (!breachStatus || !telemetryStatus) return;

            breachStatus.className = "rounded-xl border px-4 py-3 text-sm font-semibold";
            telemetryStatus.className = "rounded-xl border px-4 py-3 text-sm";

            if (breached) {
                breachStatus.textContent = "Breach Status: WORMHOLE OPEN";
                breachStatus.classList.add("border-rose-500/60", "bg-rose-500/10", "text-rose-200");
                telemetryStatus.textContent = "Telemetry: " + message;
                telemetryStatus.classList.add("border-rose-500/40", "bg-rose-500/5", "text-rose-100");
                return;
            }

            if (neutralised) {
                breachStatus.textContent = "Breach Status: CONTAINED";
                breachStatus.classList.add("border-emerald-500/60", "bg-emerald-500/10", "text-emerald-200");
                telemetryStatus.textContent = "Telemetry: " + message;
                telemetryStatus.classList.add("border-emerald-500/40", "bg-emerald-500/5", "text-emerald-100");
                return;
            }

            breachStatus.textContent = "Breach Status: Pending";
            breachStatus.classList.add("border-slate-700/60", "bg-slate-950/70", "text-slate-200");
            telemetryStatus.textContent = "Telemetry: " + message;
            telemetryStatus.classList.add("border-slate-700/60", "bg-slate-950/70", "text-slate-200");
        }

        function payloadPresent(value) {
            return value.toUpperCase().includes(PAYLOAD.toUpperCase());
        }

        function createQuery(codename, passcode, secureMode) {
            if (!secureMode) {
                return `SELECT * FROM agents WHERE codename = '${codename}' AND passcode = '${passcode}';`;
            }
            return "SELECT * FROM agents WHERE codename = ? AND passcode = ?;";
        }

        function matchAgents(codename, passcode) {
            return AGENT_DB.filter((agent) => agent.codename === codename && agent.passcode === passcode);
        }

        function resetLab() {
            if (codenameInput) codenameInput.value = "GhostWolf";
            if (passcodeInput) passcodeInput.value = "hunter2";
            if (secureToggle) secureToggle.checked = false;
            if (logOutput) logOutput.textContent = "$ Awaiting input‚Ä¶";
            stats.attempts = 0;
            stats.breaches = 0;
            stats.secureRuns = 0;
            renderStats();
            setStatuses({ breached: false, neutralised: false, message: "Wormhole readings stable" });
            vaultUnlocked = false;
            lockVault();
        }

        if (form) {
            form.addEventListener("submit", (event) => {
                event.preventDefault();

                const codename = codenameInput.value.trim();
                const passcode = passcodeInput.value.trim();
                const secureMode = secureToggle.checked;

                stats.attempts += 1;

                const query = createQuery(codename, passcode, secureMode);
                const rows = matchAgents(codename, passcode);
                const payloadFired = payloadPresent(codename) || payloadPresent(passcode);

                const logLines = [`$ ${query}`, "", "Result:"];
                let breached = false;
                let neutralised = false;

                if (!secureMode && payloadFired) {
                    stats.breaches += 1;
                    breached = true;
                    logLines.push(
                        AGENT_DB.map((agent, idx) => `  ${idx + 1}. ${agent.codename} ‚Äî ${agent.clearance}`).join("\n") || "  0 rows"
                    );
                    logLines.push("", "[Secure Mode DISABLED]");
                    setStatuses({
                        breached: true,
                        neutralised: false,
                        message: "Alien payload bypassed authentication. Immediate containment required.",
                    });
                } else {
                    const matchedRows =
                        rows.length > 0
                            ? rows.map((agent, idx) => `  ${idx + 1}. ${agent.codename} ‚Äî ${agent.clearance}`).join("\n")
                            : "  0 rows";
                    logLines.push(matchedRows);
                    logLines.push("", secureMode ? "[Secure Mode ENABLED]" : "[Secure Mode DISABLED]");

                    if (secureMode && payloadFired && rows.length === 0) {
                        stats.secureRuns += 1;
                        neutralised = true;
                        setStatuses({
                            breached: false,
                            neutralised: true,
                            message: "Payload treated as data. Wormhole collapsing.",
                        });
                    } else if (secureMode && rows.length > 0) {
                        stats.secureRuns += 1;
                        neutralised = true;
                        setStatuses({
                            breached: false,
                            neutralised: true,
                            message: `Agent ${rows[0].codename} authenticated successfully.`,
                        });
                    } else {
                        setStatuses({
                            breached: false,
                            neutralised: false,
                            message: "Partial containment. Enable secure mode to neutralize payloads.",
                        });
                    }
                }

                if (logOutput) {
                    logOutput.textContent = logLines.join("\n");
                }

                if (secureMode && neutralised && !vaultUnlocked) {
                    unlockVault();
                    vaultUnlocked = true;
                }

                renderStats();
            });
        }

        if (btnLoadPayload) {
            btnLoadPayload.addEventListener("click", () => {
                if (codenameInput) codenameInput.value = PAYLOAD;
                if (passcodeInput) passcodeInput.value = "hunter2";
                if (secureToggle) secureToggle.checked = false;
                vaultUnlocked = false;
                lockVault();
                setStatuses({
                    breached: false,
                    neutralised: false,
                    message: "Payload primed. Execute with secure mode off to observe the breach.",
                });
            });
        }

        if (btnLoadAgent) {
            btnLoadAgent.addEventListener("click", () => {
                if (codenameInput) codenameInput.value = "GhostWolf";
                if (passcodeInput) passcodeInput.value = "hunter2";
                if (secureToggle) secureToggle.checked = true;
                setStatuses({
                    breached: false,
                    neutralised: false,
                    message: "GhostWolf credentials ready. Execute with secure mode on for validation.",
                });
            });
        }

        if (btnResetLab) {
            btnResetLab.addEventListener("click", resetLab);
        }

        resetLab();
    </script>
  </body>
</html>
